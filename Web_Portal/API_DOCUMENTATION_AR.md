# ๐ก ุชูุซูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API)

## ุงูุฑุงุจุท ุงูุฃุณุงุณู (Base URL)
```
http://localhost:8000/api/auth
```

---

## ๐ ููุงุท ุงูููุงูุฉ ุงูุนุงูุฉ (Public Endpoints)

### 1. ุชุณุฌูู ุงูุฏุฎูู (Login)
**POST** `/login/`

ุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ. ููุฑุฌุน ุงุณุชุฌุงุจุงุช ูุฎุชููุฉ ุจูุงุกู ุนูู ุญุงูุฉ ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ (2FA).

**ุฌุณู ุงูุทูุจ (Request Body):**
```json
{
  "username": "demo",
  "password": "Demo@123"
}
```

**ุงูุงุณุชุฌุงุจุฉ - ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ ูุทููุจุฉ (2FA Required):**
```json
{
  "status": "2FA_REQUIRED",
  "message": "Please enter your OTP code",
  "temp_token": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

**ุงูุงุณุชุฌุงุจุฉ - ุงูุฅุนุฏุงุฏ ูุทููุจ (Setup Required):**
```json
{
  "status": "SETUP_REQUIRED",
  "message": "2FA Setup Required",
  "tokens": {
    "access": "eyJ0eXAiOiJKV1QiLCJhbGc...",
    "refresh": "eyJ0eXAiOiJKV1QiLCJhbGc..."
  }
}
```

**ุงุณุชุฌุงุจุฉ ุงูุฎุทุฃ:**
```json
{
  "non_field_errors": ["Incorrect Credentials"]
}
```

---

## ๐ ููุงุท ุงูููุงูุฉ ุงููุญููุฉ (Protected Endpoints)

ุชุชุทูุจ ุฌููุน ููุงุท ุงูููุงูุฉ ุงููุญููุฉ ูุฌูุฏ ุชุฑููุณุฉ `Authorization`:
```
Authorization: Bearer {access_token}
```

### 2. ุฅุนุฏุงุฏ ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ - ุงูุญุตูู ุนูู ุฑูุฒ QR
**GET** `/setup-2fa/`

ุชูููุฏ ุฑูุฒ QR ูููุชุงุญ ุณุฑู ูุฅุนุฏุงุฏ ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ.

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "secret": "JBSWY3DPEHPK3PXP",
  "qr_code": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
}
```

**ุงุณุชุฌุงุจุฉ ุงูุฎุทุฃ:**
```json
{
  "error": "2FA already active. Revoke first."
}
```

---

### 3. ุฅุนุฏุงุฏ ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ - ุงูุชุญูู ูู ุงูุฑูุฒ
**POST** `/setup-2fa/`

ุงูุชุญูู ูู ุฑูุฒ OTP ูุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ.

**ุฌุณู ุงูุทูุจ (Request Body):**
```json
{
  "otp_code": "123456"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "status": "SUCCESS",
  "message": "2FA Enabled Successfully"
}
```

**ุงุณุชุฌุงุจุฉ ุงูุฎุทุฃ:**
```json
{
  "error": "Invalid Code"
}
```

---

### 4. ุงูุชุญูู ูู OTP
**POST** `/verify-2fa/`

ุงูุชุญูู ูู ุฑูุฒ OTP ุฃุซูุงุก ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู.

**ุฌุณู ุงูุทูุจ (Request Body):**
```json
{
  "otp_code": "123456"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "status": "SUCCESS",
  "tokens": {
    "access": "eyJ0eXAiOiJKV1QiLCJhbGc...",
    "refresh": "eyJ0eXAiOiJKV1QiLCJhbGc..."
  }
}
```

**ุงุณุชุฌุงุจุฉ ุงูุฎุทุฃ:**
```json
{
  "error": "Invalid OTP"
}
```

---

### 5. ุงูุญุตูู ุนูู ุงูุฃุฌูุฒุฉ (Get Devices)
**GET** `/devices/`

ุณุฑุฏ ุฌููุน ุฃุฌูุฒุฉ ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ ุงููุดุทุฉ ูููุณุชุฎุฏู ุงููุตุงุฏู ุนููู.

**ุงูุงุณุชุฌุงุจุฉ:**
```json
[
  {
    "id": 1,
    "name": "My Device",
    "is_active": true,
    "created_at": "2026-02-03T18:30:00Z",
    "last_used_at": "2026-02-03T18:45:00Z"
  }
]
```

---

### 6. ุญุฐู ุฌูุงุฒ (Delete Device)
**DELETE** `/devices/{id}/`

ุฅุฒุงูุฉ ุฌูุงุฒ ูุตุงุฏูุฉ ุซูุงุฆูุฉ.

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "status": "DELETED"
}
```

**ุงุณุชุฌุงุจุฉ ุงูุฎุทุฃ:**
```json
{
  "error": "Not found"
}
```

---

## ๐ ุฅุฏุงุฑุฉ ุฑููุฒ JWT

### ุชุญุฏูุซ ุงูุฑูุฒ (Token Refresh)
**POST** `/token/refresh/`

ุชุญุฏูุซ ุฑูุฒ ุงููุตูู (access token) ููุชูู ุงูุตูุงุญูุฉ.

**ุฌุณู ุงูุทูุจ (Request Body):**
```json
{
  "refresh": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "access": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

---

## ๐ ุฑููุฒ ุงูุญุงูุฉ (Status Codes)

| ุงูุฑูุฒ | ุงููุนูู |
|------|---------|
| 200 | ูุฌุงุญ (Success) |
| 400 | ุทูุจ ุบูุฑ ุตุงูุญ (ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ) |
| 401 | ุบูุฑ ูุตูุญ ุจู (ุฑูุฒ ุบูุฑ ุตุงูุญ/ููุชูู) |
| 404 | ุบูุฑ ููุฌูุฏ |
| 500 | ุฎุทุฃ ูู ุงูุฎุงุฏู |

---

## ๐ ุชุฏูู ุงููุตุงุฏูุฉ

### ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ
1. **POST** `/login/` โ ุงูุญุตูู ุนูู `SETUP_REQUIRED` + tokens
2. **GET** `/setup-2fa/` โ ุงูุญุตูู ุนูู ุฑูุฒ QR
3. ูุณุญ ุฑูุฒ QR ุจุงุณุชุฎุฏุงู ุชุทุจูู ุงููุตุงุฏูุฉ
4. **POST** `/setup-2fa/` ูุน ุฑูุฒ OTP โ ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ
5. ุงููุตูู ุฅูู ููุญุฉ ุงูุชุญูู

### ุงููุณุชุฎุฏู ุงูุนุงุฆุฏ
1. **POST** `/login/` โ ุงูุญุตูู ุนูู `2FA_REQUIRED` + temp_token
2. **POST** `/verify-2fa/` ูุน ุฑูุฒ OTP โ ุงูุญุตูู ุนูู ุฑููุฒ ุงููุตูู ุงููุงููุฉ
3. ุงููุตูู ุฅูู ููุญุฉ ุงูุชุญูู

---

## ๐ก๏ธ ููุงุญุธุงุช ุฃูููุฉ

1. **ุงูุฑููุฒ ุชูุชูู ุตูุงุญูุชูุง ุจุนุฏ ุณุงุนุฉ ูุงุญุฏุฉ** - ุงุณุชุฎุฏู ุฑูุฒ ุงูุชุญุฏูุซ ููุญุตูู ุนูู ุฑูุฒ ูุตูู ุฌุฏูุฏ
2. **ุฑููุฒ ุงูุชุญุฏูุซ ุชูุชูู ุตูุงุญูุชูุง ุจุนุฏ 7 ุฃูุงู** - ูุฌุจ ุนูู ุงููุณุชุฎุฏู ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู
3. **ุฑููุฒ OTP ุชุชุบูุฑ ูู 30 ุซุงููุฉ** - ุจูุงุกู ุนูู ุฎูุงุฑุฒููุฉ TOTP
4. **ุงูููุงุชูุญ ุงูุณุฑูุฉ ูุฑูุฏุฉ ููู ุฌูุงุฒ** - ูุง ุชุดุงุฑููุง ุฃู ุชุนุฑุถูุง ุฃุจุฏูุง
5. **CORS ููุนู ูููุถูู ุงููุญูู (localhost)** - ูู ุจุงูุชุญุฏูุซ ููุทุงูุงุช ุงูุฅูุชุงุฌ

---

## ๐งช ุงูุงุฎุชุจุงุฑ ุจุงุณุชุฎุฏุงู cURL

### ุชุณุฌูู ุงูุฏุฎูู
```bash
curl -X POST http://localhost:8000/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{"username":"demo","password":"Demo@123"}'
```

### ุงูุญุตูู ุนูู ุฑูุฒ QR
```bash
curl -X GET http://localhost:8000/api/auth/setup-2fa/ \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### ุงูุชุญูู ูู OTP
```bash
curl -X POST http://localhost:8000/api/auth/verify-2fa/ \
  -H "Authorization: Bearer YOUR_TEMP_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"otp_code":"123456"}'
```

### ุนุฑุถ ุงูุฃุฌูุฒุฉ
```bash
curl -X GET http://localhost:8000/api/auth/devices/ \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

---

## ๐ ููุงุญุธุงุช

- ุฌููุน ุงูุฃููุงุช ุจุชูููุช UTC
- ุฌููุน ุงูุงุณุชุฌุงุจุงุช ุจุชูุณูู JSON
- ูุฌุจ ุฃู ุชููู ุฑููุฒ OTP ููููุฉ ูู 6 ุฃุฑูุงู ุจุงูุถุจุท
- ูููู ุชุฎุตูุต ุฃุณูุงุก ุงูุฃุฌูุฒุฉ (ุงูุญุฏ ุงูุฃูุตู 64 ุญุฑููุง)
- ูููู ุชุณุฌูู ุฃุฌูุฒุฉ ูุชุนุฏุฏุฉ ููู ูุณุชุฎุฏู

---

**ููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน ุงูููู ุงูุฑุฆูุณู [README_AR.md](../README_AR.md)**
